document.onkeydown=function(c){var d,b,a;if(!c){c=window.event;d=c.srcElement;b=c.keyCode;if(b==13){a=d.tagName;if(a=="TEXTAREA"){return true}else{return false}}}else{d=c.target;b=c.keyCode;if(b==13){a=d.tagName;if(a=="INPUT"){return false}else{return true}}}};function checkChgPwd(g){var h=g,d=h.attr("id"),a=$.trim(h.val()),c=h.next(),e={};var i=new tool(),j="",f="";if(d=="curPassword"){j=showTips(a,c,d);if(j.flag==true){e.type="POST";e.async=false;e.url="/ajax/Login_Register/check.ashx";e.data={userID:$.cookie("userID"),pwd:a};e.success=function(k){f=k};i.ajax(e);switch(f){case"1":c.addClass("focusTips").html('<img src="../image/tick_circle.png" alt="正确">');return true;case"-2":c.removeClass("focusTips").addClass("logTips").html("密码错误");return false;default:c.removeClass("focusTips").addClass("logTips").html("请重新输入密码");return false}}}if(d=="newPassword"){j=showTips(a,c,d);return j.flag}if(d=="comfirmPassword"){var b=$("#newPassword").val();if(i.IsEmpty(b)){c.removeClass("focusTips").addClass("logTips").html("重复密码不能为空！");return false}if(b.length<6){c.removeClass("focusTips").addClass("logTips").html("重复密码长度不能小于6！");return false}if(a!=$.trim($("#newPassword").val())){c.removeClass("focusTips").addClass("logTips").html("两次密码不一致！");return false}else{c.removeClass("logTips").addClass("focusTips").html('<img src="../image/tick_circle.png" alt="正确">');return true}}}function showTips(a,c,d){var b=new tool();if(b.checkPassword(a).isCorrect){c.removeClass("logTips").addClass(d=="curPassword"?"":"focusTips").html(d=="curPassword"?"":'<img src="../image/tick_circle.png" alt="正确">');return{flag:true}}else{c.removeClass("focusTips").addClass("logTips").html(b.checkPassword(a).message);return{flag:false}}}function btnSubmitClick(){var b=$("#curPassword"),a=$("#newPassword"),c=$("#comfirmPassword");if(checkChgPwd(b)==false||checkChgPwd(a)==false||checkChgPwd(c)==false){return}else{var d="curPass="+$.trim(b.val())+"&newPass="+$.trim(a.val());$.ajax({url:"../ajax/UpdateUserInfo.ashx",data:d,dataType:"json",success:function(e){$("#personalPwd input[type='password']").val("");$("#personalPwd .focusTips").html("");$.cookie("userID",null,{path:"/"});$.cookie("kcb",null,{path:"/"});$.cookie("nickname",null,{path:"/"});$.cookie("RelatedWebID",null,{path:"/"});$.cookie("inviteUserID",null,{path:"/"});$.cookie("preURL",null,{path:"/"});$.XYTipsWindow({___title:"开吃吧提示",___drag:"___boxTitle",___width:"300px",___height:"100px",___content:'text:<p style="color:#555;text-align: center;margin-top:40px;font-size:16px;font-weight:bold;">'+e.Message+"请重新登录!</p>",___showbg:true,___time:1800});window.location="/login.aspx";return false},error:function(e){$.XYTipsWindow({___title:"开吃吧提示",___drag:"___boxTitle",___width:"300px",___height:"100px",___content:'text:<p style="color:#555;text-align: center;margin-top:40px;font-size:16px;font-weight:bold;">修改密码失败,请重试!</p>',___showbg:true,___time:1800})}})}}function showPersnoalInfoPanel(){$("#alter_info").show();("#ChgPwd").hide();$("#showInfo").click()}function showPasswordPanel(){$("#ChgPwd").show();$("#alter_info").hide();$("#showPwd").click()}function chgNickName(){$("#dispName").css("display","none");$("#updateName").css("display","block")}function checkNickname(){if($("#NewNickname").val().length==0){$("#nicknameNotEmpty").css("display","block");setTimeout(function(){$("#nicknameNotEmpty").css("display","none")},3000);return false}else{return true}}$(function(){var a=$.cookie("userID");$("#invite_url").select().focus();$(".click_bind").bind("click",function(){$(".minLoginBg,.minLogReg").css("display","block")});$("input[type='password']").blur(function(){checkChgPwd($(this))});$("#chgName").live("click",function(){chgNickName()})});